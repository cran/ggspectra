<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Pedro J. Aphalo" />

<meta name="date" content="2020-01-16" />

<title>User Guide: 3 Plotting transformed data</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">User Guide: 3 Plotting transformed data</h1>
<h3 class="subtitle">‘ggspectra’ 0.3.5</h3>
<h4 class="author">Pedro J. Aphalo</h4>
<h4 class="date">2020-01-16</h4>


<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#set-up">Set up</a></li>
<li><a href="#visualizing-the-effect-of-methods">Visualizing the effect of methods</a></li>
</ul>
</div>

<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Package <code>ggspectra</code> extends <code>ggplot2</code> with stats, geoms, scales and annotations suitable for light spectra. It also defines <code>ggplot()</code> and <code>autoplot()</code> methods specialized for the classes defined in package <code>photobiology</code> for storing different types of spectral data. The <code>autoplot()</code> methods are described separately in vignette ‘Autoplot Methods’.</p>
<p>The new elements can be freely combined with methods and functions defined in packages <code>ggplot2</code>, <code>scales</code>, <code>ggrepel</code> and <code>cowplot</code>.</p>
<p>This third part of the User Guide describes how to combine manipulation of spectral data with plotting. This streamlined coding is made possible by the enhancement implemented in ‘ggspectra’ (&gt;= 0.3.5) and in addition some of the examples make use of methods available only in ‘photobiology’ (&gt;= 0.9.30).</p>
<p>In ‘ggspectra’ (&gt;= 0.3.5) the data member of <code>gg</code> (ggplot) objects remains as an object of the classes for spectral data defined in ‘photobiology’ instead as being converted into a plain <code>data.frame</code>. This makes it possible some data manipulations to be done with methods specific to spectral data.</p>
</div>
<div id="set-up" class="section level2">
<h2>Set up</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">library</span>(rlang)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">library</span>(photobiology)</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">library</span>(photobiologyWavebands)</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">library</span>(ggspectra)</a>
<a class="sourceLine" id="cb1-7" title="7"></a>
<a class="sourceLine" id="cb1-8" title="8">good_label_repel &lt;-<span class="st"> </span><span class="kw">packageVersion</span>(<span class="st">&#39;ggrepel&#39;</span>) <span class="op">!=</span><span class="st"> &quot;0.8.0&quot;</span> <span class="co">#||</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">#  packageVersion(&#39;ggplot2&#39;) &gt;= &quot;3.1.0&quot;</span></a></code></pre></div>
<p>Create a collection of two source_spct objects.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">two_suns.mspct &lt;-<span class="st"> </span><span class="kw">source_mspct</span>(<span class="kw">list</span>(<span class="dt">sun1 =</span> sun.spct, <span class="dt">sun2 =</span> sun.spct <span class="op">/</span><span class="st"> </span><span class="dv">2</span>))</a></code></pre></div>
<p>We bind the two spectra in the collection into a single spectral object. This object includes an indexing factor, by default names <code>spct.idx</code>. We use this new object to later on demonstrate grouping in ggplots.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">two_suns.spct &lt;-<span class="st"> </span><span class="kw">rbindspct</span>(two_suns.mspct)</a></code></pre></div>
<p>We change the default theme.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())</a></code></pre></div>
</div>
<div id="visualizing-the-effect-of-methods" class="section level2">
<h2>Visualizing the effect of methods</h2>
<p>As from version 0.3.5 the class of the spectral object stored by <code>ggplot()</code> is no longer stripped, data transformations in layers can use methods from package ‘photobiology’ that expect spectral objects as input. A simple example of spectral data smoothing follows.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> sun.spct, <span class="dt">mapping =</span> <span class="kw">aes</span>(w.length, s.e.irrad)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> sun.spct <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">smooth_spct</span>(<span class="dt">method =</span> <span class="st">&quot;supsmu&quot;</span>), </a>
<a class="sourceLine" id="cb5-4" title="4">            <span class="dt">mapping =</span> <span class="kw">aes</span>(w.length, s.e.irrad), </a>
<a class="sourceLine" id="cb5-5" title="5">            <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="fl">1.2</span>)</a></code></pre></div>
<p>Can be now simplified because <code>.</code> refers to a <code>data</code> member of class <code>source_spct</code> while the automatic mapping remains valid because <code>smooth_spct()</code> returns a new <code>source_spct</code> object with the same column names as <code>sun.spct</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">ggplot</span>(sun.spct) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> . <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">smooth_spct</span>(<span class="dt">method =</span> <span class="st">&quot;supsmu&quot;</span>), </a>
<a class="sourceLine" id="cb6-4" title="4">            <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="fl">1.2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The easiest way of plotting photon spectral irardiance instead of spectral energy irradiance is to temporarily change the default radiation unit.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">photon_as_default</span>()</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">ggplot</span>(sun.spct) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> . <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">smooth_spct</span>(<span class="dt">method =</span> <span class="st">&quot;supsmu&quot;</span>), </a>
<a class="sourceLine" id="cb7-5" title="5">            <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="fl">1.2</span>)</a>
<a class="sourceLine" id="cb7-6" title="6"><span class="kw">unset_radiation_unit_default</span>()</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Of course the default data does not need to be plotted, so this provides a roundabout way of applying methods,</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">ggplot</span>(sun.spct) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> . <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">smooth_spct</span>(<span class="dt">method =</span> <span class="st">&quot;supsmu&quot;</span>), </a>
<a class="sourceLine" id="cb8-3" title="3">            <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="fl">1.2</span>)</a></code></pre></div>
<p>which is equivalent to doing the transformation ahead of plotting, which might be preferable.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">sun.spct <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="st">  </span><span class="kw">smooth_spct</span>(<span class="dt">method =</span> <span class="st">&quot;supsmu&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="fl">1.2</span>)</a></code></pre></div>
<p>However, when using different transformations in different layers we need to apply them at each layer.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">ggplot</span>(sun.spct) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> . <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">smooth_spct</span>(<span class="dt">method =</span> <span class="st">&quot;custom&quot;</span>), </a>
<a class="sourceLine" id="cb10-4" title="4">            <span class="dt">colour =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> . <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">smooth_spct</span>(<span class="dt">method =</span> <span class="st">&quot;lowess&quot;</span>), </a>
<a class="sourceLine" id="cb10-6" title="6">            <span class="dt">colour =</span> <span class="st">&quot;green&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> . <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">smooth_spct</span>(<span class="dt">method =</span> <span class="st">&quot;supsmu&quot;</span>), </a>
<a class="sourceLine" id="cb10-8" title="8">            <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>)</a></code></pre></div>
<pre><code>## 24 possibly &#39;bad&#39; values in smoothed spectral irradiance</code></pre>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Of course, this approach works both with <em>geoms</em> and <em>stats</em>, but one should remember that these layer functions do not “see” the original data object, but instead a new data frame containing the mapped variables in columns named according to <em>aesthetics</em>. The next example demostrates this and illustrates that smoothing displaces the wavelength of maximum spectral irradiance.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">ggplot</span>(sun.spct) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="st">  </span><span class="kw">stat_peaks</span>(<span class="dt">colour =</span> <span class="st">&quot;green&quot;</span>, <span class="dt">span =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> . <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">smooth_spct</span>(<span class="dt">method =</span> <span class="st">&quot;supsmu&quot;</span>), </a>
<a class="sourceLine" id="cb12-5" title="5">            <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="fl">1.2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="st">  </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> . <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">smooth_spct</span>(<span class="dt">method =</span> <span class="st">&quot;supsmu&quot;</span>),</a>
<a class="sourceLine" id="cb12-7" title="7">             <span class="dt">colour =</span> <span class="st">&quot;green&quot;</span>, <span class="dt">span =</span> <span class="ot">NULL</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>We can easily highlight a wavelength region.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">ggplot</span>(sun.spct) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> . <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">trim_wl</span>(<span class="dt">range =</span> <span class="kw">PAR</span>()), <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">ggplot</span>(sun.spct) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> . <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="st">              </span><span class="kw">trim_wl</span>(<span class="dt">range =</span> <span class="kw">PAR</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tag</span>(),</a>
<a class="sourceLine" id="cb14-5" title="5">            <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">color =</span> wl.color),</a>
<a class="sourceLine" id="cb14-6" title="6">            <span class="dt">shape =</span> <span class="st">&quot;circle&quot;</span>, <span class="dt">size =</span> <span class="fl">1.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-7" title="7"><span class="st">  </span><span class="kw">scale_color_identity</span>()</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">ggplot</span>(sun.spct) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="st">  </span><span class="kw">geom_area</span>(<span class="dt">data =</span> . <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="st">              </span><span class="kw">trim_wl</span>(<span class="dt">range =</span> <span class="kw">VIS</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="st">              </span><span class="kw">tag</span>(<span class="dt">w.band =</span> <span class="kw">VIS_bands</span>()),</a>
<a class="sourceLine" id="cb15-5" title="5">            <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">fill =</span> wb.color)) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="st">  </span><span class="kw">scale_fill_identity</span>()</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
